<html class="notion-html"><head lang="en"><meta charset="utf-8"/><meta content="width=device-width,height=device-height,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover" name="viewport"/><title>5.2. 词嵌入方法</title><meta content="en_US" property="og:locale"/><link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon"/><link href="/images/logo-ios.png" rel="apple-touch-icon"/><meta content="yes" name="apple-mobile-web-app-capable"/><meta content="telephone=no" name="format-detection"/><meta content="no" name="msapplication-tap-highlight"/><link href="e218a1aef6df86309cb95b61e446888efa3b0379.css" media="print" rel="stylesheet"/><link href="e1d809d762eeca23edf0cb31bb17bf3c703085f5.css" rel="stylesheet"/><link href="ea336c780f905bf8e5199e24de64f0cf84362824.css" rel="stylesheet"/></head><body class="notion-body"><style>body{background:#fff}body.dark{background:#191919}@keyframes startup-shimmer-animation{0%{transform:translateX(-100%) translateZ(0)}100%{transform:translateX(100%) translateZ(0)}}@keyframes startup-shimmer-fade-in{0%{opacity:0}100%{opacity:1}}@keyframes startup-spinner-rotate{0%{transform:rotate(0) translateZ(0)}100%{transform:rotate(360deg) translateZ(0)}}#initial-loading-spinner{position:fixed;height:100vh;width:100vw;z-index:-1;display:none;align-items:center;justify-content:center;opacity:.5}#initial-loading-spinner svg{height:24px;width:24px;animation:startup-spinner-rotate 1s linear infinite;transform-origin:center center;pointer-events:none}#skeleton{background:#fff;position:fixed;height:100vh;width:100vw;z-index:-1;display:none;overflow:hidden}#initial-loading-spinner.show,#skeleton.show{display:flex}body.dark #skeleton{background:#191919}.notion-front-page #skeleton,.notion-mobile #skeleton{display:none}#skeleton-sidebar{background-color:#fbfbfa;box-shadow:inset -1px 0 0 0 rgba(0,0,0,.025);display:flex;width:240px;flex-direction:column;padding:12px 14px;overflow:hidden}body.dark #skeleton-sidebar{background-color:#202020;box-shadow:inset -1px 0 0 0 rgba(255,255,255,.05)}#skeleton.isElectron #skeleton-sidebar{padding-top:46px}#skeleton .row{display:flex;margin-bottom:8px;align-items:center}#skeleton .row.fadein{animation:1s ease-in 0s 1 normal both running startup-shimmer-fade-in}#skeleton .chevron{width:12px;height:12px;display:block;margin-right:4px;fill:rgba(227,226,224,.5)}body.dark #skeleton .chevron{fill:#2f2f2f}.startup-shimmer{background:rgba(227,226,224,.5);overflow:hidden;position:relative}body.dark .startup-shimmer{background:#2f2f2f}.startup-shimmer::before{content:"";position:absolute;height:100%;width:100%;z-index:1;animation:1s linear infinite startup-shimmer-animation;background:linear-gradient(90deg,transparent 0,rgba(255,255,255,.4) 50%,transparent 100%)}body.dark .startup-shimmer::before{background:linear-gradient(90deg,transparent 0,rgba(86,86,86,.4) 50%,transparent 100%)}#skeleton .icon{width:20px;height:20px;border-radius:4px}#skeleton .text{height:10px;border-radius:10px}#skeleton .draggable{-webkit-app-region:drag;position:absolute;top:0;left:0;width:100%;height:36px;display:none}#skeleton.isElectron .draggable{display:block}</style><style id="scroll-properties">
			::-webkit-scrollbar {
				width: 10px;
				height: 10px;
			}
			::-webkit-scrollbar {
				background: transparent;
			}
			::-webkit-scrollbar-track {
				background: #EDECE9;
			}
			::-webkit-scrollbar-thumb {
				background:#D3D1CB;
			}
			::-webkit-scrollbar-thumb:hover {
				background:#AEACA6;
			}
		</style><div id="notion-app"><div class="notion-app-inner notion-light-theme" style='color: rgb(55, 53, 47); fill: currentcolor; line-height: 1.5; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; -webkit-font-smoothing: auto; background-color: white;'><div style="height: 100%;"><div class="notion-cursor-listener" style="width: 100vw; height: 100%; position: relative; display: flex; flex: 1 1 0%; background: white; cursor: text;"><div class="" style="display: flex; flex-direction: column; width: 100%; overflow: hidden;"><div style="max-width: 100vw; z-index: 100; background: white; user-select: none;"><div class="notion-topbar" style="width: 100%; max-width: 100vw; height: 45px; opacity: 1; transition: opacity 700ms ease 0s, color 700ms ease 0s; position: relative;"><div style="display: flex; justify-content: space-between; align-items: center; overflow: hidden; height: 45px; padding-left: 12px; padding-right: 10px;"><div class="notranslate shadow-cursor-breadcrumb" style="display: flex; align-items: center; line-height: 1.2; font-size: 14px; height: 100%; flex-grow: 0; margin-right: 8px; min-width: 0px;"><div class="notion-selectable notion-page-block" data-block-id="6f173729-5884-4d32-8452-4cbeea3e462c" style="display: flex; align-items: center; min-width: 0px;"><a href="index.html" rel="noopener noreferrer" style="display: flex; color: rgb(55, 53, 47); text-decoration: none; user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 4px; font-size: inherit; line-height: 1.2; min-width: 0px; padding: 2px;"><div style="display: flex; align-items: center; min-width: 0px;"><div class="notion-record-icon notranslate" style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px; border-radius: 0.25em; flex-shrink: 0; margin-right: 6px; font-weight: 500;"><div style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px;"><div style="height: 14px; width: 14px; font-size: 14px; line-height: 1; margin-left: 0px; color: black;"><img alt="🌃" aria-label="🌃" class="notion-emoji" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" style="width: 100%;
height: 100%;
background: url(f87457017f44d1d87f6d662556796277387c1c28.png) 8.47458% 11.8644%/6000% 6000%"/></div></div></div><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px;">BMPixel网络日志</div></div></a></div><span style="margin-left: 2px; margin-right: 2px; color: rgba(55, 53, 47, 0.5);">/</span><div class="notion-selectable notion-collection_view-block" data-block-id="27dbe900-3c41-4c13-bd5a-432418911021" style="display: flex; align-items: center; min-width: 0px;"><a href="27dbe9003c414c13bd5a432418911021.html" rel="noopener noreferrer" style="display: flex; color: rgb(55, 53, 47); text-decoration: none; user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 4px; font-size: inherit; line-height: 1.2; min-width: 0px; padding: 2px;"><div style="display: flex; align-items: center; min-width: 0px;"><div class="notion-record-icon notranslate" style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px; border-radius: 0.25em; flex-shrink: 0; margin-right: 6px; font-weight: 500;"><div style="display: flex; align-items: center; justify-content: center; height: 20px; width: 20px;"><div style="height: 14px; width: 14px; font-size: 14px; line-height: 1; margin-left: 0px; color: black;"><img alt="🌃" aria-label="🌃" class="notion-emoji" src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" style="width: 100%;
height: 100%;
background: url(f87457017f44d1d87f6d662556796277387c1c28.png) 8.47458% 11.8644%/6000% 6000%"/></div></div></div><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px;">网络日志</div></div></a></div><span style="margin-left: 2px; margin-right: 2px; color: rgba(55, 53, 47, 0.5);">/</span><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 1; white-space: nowrap; height: 24px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 6px; padding-right: 6px; color: rgb(55, 53, 47);" tabindex="0"><div class="notranslate" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 240px;">5.2. 词嵌入方法</div></div></div><div style="flex-grow: 1; flex-shrink: 1;"></div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="0"><svg class="searchNew" style="width: 14px; height: 14px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden; margin-right: 6px;" viewBox="0 0 17 17"><path d="M6.78027 13.6729C8.24805 13.6729 9.60156 13.1982 10.709 12.4072L14.875 16.5732C15.0684 16.7666 15.3232 16.8633 15.5957 16.8633C16.167 16.8633 16.5713 16.4238 16.5713 15.8613C16.5713 15.5977 16.4834 15.3516 16.29 15.1582L12.1504 11.0098C13.0205 9.86719 13.5391 8.45215 13.5391 6.91406C13.5391 3.19629 10.498 0.155273 6.78027 0.155273C3.0625 0.155273 0.0214844 3.19629 0.0214844 6.91406C0.0214844 10.6318 3.0625 13.6729 6.78027 13.6729ZM6.78027 12.2139C3.87988 12.2139 1.48047 9.81445 1.48047 6.91406C1.48047 4.01367 3.87988 1.61426 6.78027 1.61426C9.68066 1.61426 12.0801 4.01367 12.0801 6.91406C12.0801 9.81445 9.68066 12.2139 6.78027 12.2139Z"></path></svg>Search</div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="0">Duplicate</div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: flex; align-items: center; justify-content: center; width: 32px; height: 28px; border-radius: 3px;" tabindex="0"><svg class="dots" style="width: 18px; height: 18px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden;" viewBox="0 0 13 3"><g><path d="M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"></path><path d="M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"></path><path d="M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"></path></g></svg></div><div style="flex: 0 0 auto; width: 1px; height: 16px; margin-left: 8px; margin-right: 8px; background: rgba(55, 53, 47, 0.16);"></div><div role="button" style="user-select: none; transition: background 20ms ease-in 0s; cursor: pointer; display: inline-flex; align-items: center; flex-shrink: 0; white-space: nowrap; height: 28px; border-radius: 4px; font-size: 14px; line-height: 1.2; min-width: 0px; padding-left: 8px; padding-right: 8px; color: rgb(55, 53, 47);" tabindex="0"><svg class="notionLogo" style="width: 18px; height: 18px; display: block; fill: inherit; flex-shrink: 0; backface-visibility: hidden; margin-right: 6px;" viewBox="0 0 120 126"><path d="M 20.6927 21.9315C 24.5836 25.0924 26.0432 24.8512 33.3492 24.3638L 102.228 20.2279C 103.689 20.2279 102.474 18.7705 101.987 18.5283L 90.5477 10.2586C 88.3558 8.55699 85.4356 6.60818 79.8387 7.09563L 13.1433 11.9602C 10.711 12.2014 10.2251 13.4175 11.1939 14.3924L 20.6927 21.9315ZM 24.8281 37.9835L 24.8281 110.456C 24.8281 114.351 26.7745 115.808 31.1553 115.567L 106.853 111.187C 111.236 110.946 111.724 108.267 111.724 105.103L 111.724 33.1169C 111.724 29.958 110.509 28.2544 107.826 28.4976L 28.721 33.1169C 25.8018 33.3622 24.8281 34.8225 24.8281 37.9835ZM 99.5567 41.8711C 100.042 44.0622 99.5567 46.2512 97.3618 46.4974L 93.7143 47.2241L 93.7143 100.728C 90.5477 102.43 87.6275 103.403 85.1942 103.403C 81.2983 103.403 80.3226 102.186 77.4044 98.54L 53.5471 61.087L 53.5471 97.3239L 61.0964 99.0275C 61.0964 99.0275 61.0964 103.403 55.0057 103.403L 38.2148 104.377C 37.727 103.403 38.2148 100.973 39.9179 100.486L 44.2996 99.2717L 44.2996 51.36L 38.2158 50.8725C 37.728 48.6815 38.9431 45.5225 42.3532 45.2773L 60.3661 44.0631L 85.1942 82.0036L 85.1942 48.4402L 78.864 47.7136C 78.3781 45.0351 80.3226 43.0902 82.7569 42.849L 99.5567 41.8711ZM 7.5434 5.39404L 76.9175 0.285276C 85.4366 -0.445402 87.6285 0.0440428 92.983 3.93368L 115.128 19.4982C 118.782 22.1747 120 22.9034 120 25.8211L 120 111.187C 120 116.537 118.051 119.701 111.237 120.185L 30.6734 125.05C 25.5584 125.294 23.124 124.565 20.4453 121.158L 4.13735 99.9994C 1.21516 96.1048 0 93.191 0 89.7819L 0 13.903C 0 9.5279 1.94945 5.8785 7.5434 5.39404Z"></path></svg>Try Notion</div></div></div><div style="width: calc(100% - 0px); user-select: none;"></div></div><div class="notion-frame" style="flex-grow: 0; flex-shrink: 1; display: flex; flex-direction: column; background: white; z-index: 1; height: calc(100vh - 45px); max-height: 100%; position: relative; width: 1920px;"><div class="notion-scroller vertical" style="display: flex; flex-direction: column; z-index: 1; flex-grow: 1; position: relative; align-items: center; margin-right: 0px; margin-bottom: 0px; overflow: hidden auto;"><div style="position: absolute; top: 0px; left: 0px;"><div></div></div><div class="whenContentEditable" data-content-editable-root="true" style="caret-color: rgb(55, 53, 47); width: 100%; display: flex; flex-direction: column; position: relative; align-items: center; flex-grow: 1; --whenContentEditable--WebkitUserModify:read-write-plaintext-only;"><span style="height: 1px; width: 1px;"></span><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background:transparent; width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0; z-index: 2;"><div style="position: relative; width: 100%; display: flex; flex-direction: column; align-items: center; height: 30vh; cursor: default;"><div style="width: 100%; cursor: inherit;"><div style="display: grid; width: 100%; height: 30vh;"><div style="grid-area: 1 / 1 / auto / auto; width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="f50c132c40ea0bac965c55cad51f17f9289bab42.jpg" style="display: block; object-fit: cover; border-radius: 0px; width: 100%; height: 30vh; opacity: 1; object-position: center 50%;"/></div></div></div><div aria-hidden="true" style='background: rgba(0, 0, 0, 0.4); border-radius: 3px; color: white; font-size: 12px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; width: 180px; left: calc(50% - 90px); padding: 0.3em 1.5em; pointer-events: none; position: absolute; top: calc(50% - 10px); text-align: center; opacity: 0;'>Drag image to reposition</div></div></div><div style="width: 100%; display: flex; justify-content: center; z-index: 3; flex-shrink: 0;"><div style="max-width: 100%; min-width: 0px; width: 900px;"><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div style="max-width: 100%; padding-left: calc(96px + env(safe-area-inset-left)); width: 100%;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" style="user-select: none; --pseudoSelection--background:transparent; pointer-events: none;"><div class="notion-page-controls" style='display: flex; justify-content: flex-start; flex-wrap: wrap; margin-top: 16px; margin-bottom: 4px; margin-left: -1px; color: rgba(55, 53, 47, 0.5); font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; height: 24px; pointer-events: auto;'></div></div><div style="padding-right: calc(96px + env(safe-area-inset-right));"><div><div class="notion-selectable notion-page-block" data-block-id="96825282-65a5-4226-8233-8fb989aac3f0" style='color: rgb(55, 53, 47); font-weight: 700; line-height: 1.2; font-size: 40px; font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; cursor: text; display: flex; align-items: center;'><div contenteditable="false" data-content-editable-leaf="true" placeholder="Untitled" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">5.2. 词嵌入方法</div></div><div style="margin-left: 4px;"></div></div></div></div></div><div style="width: 100%; display: flex; flex-direction: column; align-items: center; flex-shrink: 0; flex-grow: 0;"><div contenteditable="false" data-content-editable-void="true" style="padding-left: calc(96px + env(safe-area-inset-left)); padding-right: calc(96px + env(safe-area-inset-right)); max-width: 100%; width: 100%;"><div style="width: 100%; font-size: 14px;"><div style="width: 100%; max-width: 100%; padding: 8px 0px; margin: 0px auto;"><div style="width: 100%; max-width: 100%; padding-top: 8px; margin: 0px auto;"><div style="padding-bottom: 8px;"><div style="margin: 0px;"></div></div></div></div></div><div style="width: 100%; height: 1px; background: rgba(55, 53, 47, 0.09); margin-bottom: 8px;"></div></div></div></div></div><main style="display: flex; width: 100%; justify-content: center; padding-top: 5px;"><div style="max-width: 100%; min-width: 0px; width: 900px;"><div class="notion-page-content" style="flex-shrink: 0; flex-grow: 1; max-width: 100%; display: flex; align-items: flex-start; flex-direction: column; font-size: 16px; line-height: 1.5; width: 100%; z-index: 4; padding-bottom: 30vh; padding-left: calc(96px + env(safe-area-inset-left)); padding-right: calc(96px + env(safe-area-inset-right));"><div class="notion-selectable notion-header-block" data-block-id="15dbed3f-9c31-455a-81f2-036db27313b2" style="width: 100%; max-width: 1718px; margin-top: 2em; margin-bottom: 4px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 1" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.875em; line-height: 1.3;">词嵌入方法</div></div></div><div class="notion-selectable notion-text-block" data-block-id="7293be32-b93f-4e75-b1fe-ef310bf80833" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">我们之前已经了解了怎么使用One-Hot编码单词文字，把只有人类可以有效阅读的单词转化成便于机器学习算法处理的向量。</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="15023778-d1a5-4cf7-81de-1a9e35b20d01" style="width: 100%; max-width: 1910px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="298ca17b6617e8722fb1b3add779d68adf810121.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="a9033b16-5125-471a-a759-4b4b7225fcd7" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">1*O_pTwOZZLYZabRjw3Ga21A</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="e3943a79-4b7e-4da5-b3a0-efa4cee9b93b" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">这种方法非常的简洁，但是有着不小的问题：</div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="5be4957f-f363-48a2-b846-d55bb85c67e1" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">一方面，使用动辄上万维的向量表征一个单词是在是太浪费了，如此稀疏的输入容易导致网络结构过于稀疏；</div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="0f7bca98-9c8a-4707-8ac2-8393ee7a40c7" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">这种编码无法很好的表现词和词之间的关系，任意两个词向量点积都是零，不同的词向量之间没有任何独特的关系。我们希望我们的文字编码可以表达这样的信息，比如Orange和Apple在含义上相近，对应的两个词向量也有着一定的相似性。</div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="33b22052-22dc-48c0-afcc-8e8bea212552" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">于是我们需要引入<span class="notion-enable-hover" data-token-index="1" style="font-weight:600">词嵌入（Word Embedding）</span>的概念，词嵌入是 NLP 中语言模型与表征学习技术的统称，概念上来说，它是指把一个维数为所有词的数量的高维空间（one-hot形式表示的词）“嵌入”到一个维数低得多的连续向量空间中，每个单词或词组被映射为实数域上的向量。在接下来的内容中，我们使用<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">w</span><span class="notion-enable-hover" data-token-index="4" style="font-style:italic">i</span>表示词汇表里第<span class="notion-enable-hover" data-token-index="6" style="font-style:italic">i</span>项词语的拼写，而用<span class="notion-enable-hover" data-token-index="8" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="9" style="font-style:italic">i</span>表示第<span class="notion-enable-hover" data-token-index="11" style="font-style:italic">i</span>个词语得到的词嵌入向量，而用<span class="notion-enable-hover" data-token-index="13" style="font-style:italic">o</span><span class="notion-enable-hover" data-token-index="14" style="font-style:italic">i</span>表示第<span class="notion-enable-hover" data-token-index="16" style="font-style:italic">i</span>个词语对应的One-Hot向量。</div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="9dd2494d-05a3-4778-8866-7a1a8558252c" style="width: 100%; max-width: 1718px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.5em; line-height: 1.3;">词嵌入的特点</div></div></div><div class="notion-selectable notion-text-block" data-block-id="36224d3f-fefc-453d-9f52-8679af63b1d5" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">我们现在有一个已经嵌入好的词嵌入算法，它能把可能上万维的One-hot词向量映射到一个300维的空间中，也就是得到一个300维的词向量。对于一个训练好的词嵌入算法，它的向量空间的不同维度可能是有具体意义的，如下图所示：</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="cc0dc394-1f57-47c5-aa60-8d42ab6eef1b" style="width: 100%; max-width: 1910px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="80261a31078b3dc80ba3e123448d91da70867f5b.jpg" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="e0480b1c-7cbf-4039-961b-3689baef1421" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">我们可能很想看看这些词向量到底是如何分布在300维的空间中的，但是不幸的是人类并没有直接观察300维空间的能力。幸运的是我们可以使用t-SNE等算法将高维点映射到低维空间内可视化，下图是使用t-SNE方法将一些词向量映射到2维平面上的可视化结果：</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="7e0a0843-9df4-413e-980f-4d3071155929" style="width: 100%; max-width: 1910px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="647b165dae3c0cbd228c5c5e8313f908f8bc72e4.jpg" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="d47db1aa-9b2e-42ad-9788-ee89110352f3" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">word-vector-space-similar-words</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="4f2625c6-51ee-4c8b-b53d-0303e5f0949d" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">在一个已经训练好的词嵌入模型中，我们能够在不同词语的词向量之间观察到一些关系特点：</div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="e770d2a5-7157-4b80-80b1-e6ce8a135dc1" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">不同的词向量之间存在聚类特点，意思相近的词向量会在互相之间有着较近的距离，而含义差距较大的词向量之间的距离也会比较远。</div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="8acc5d78-2bf0-4fb2-95b9-324cb0b8b190" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">词向量之间存在平行四边形关系，如果我们考虑四个词之间的相对关系：“男人”相对于“女人”，正如“国王”相对于“皇后”。我们会发现，“男人”减去“女人”的向量将和“国王”减去“皇后”的向量非常相近。“男人”减去“女人”后剩下的特点和“国王”减去“皇后”剩下的东西差不多——可能都是性别差异。具体表现在词嵌入空间中就会得到“男人”，“女人”，“国王”和“皇后”四个点构成了一个平行四边形。在上图中我们可以看到“kitchen”，“bathroom”，“table”和“shower”也构成了一个平行四边形，想来也是挺有道理。这样的语言学关系体现的地方还有很多，要知道可没人告诉词嵌入模型这些信息，这些信息都是从大量的文本数据中推断出来的。这个性质真是太棒了！有了它，我们就可以回答“奥巴马”相对于“美国”正如“___”相对于“俄罗斯”的复杂问题了，只需要寻找所有词向量中最接近于<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">e</span> − <span class="notion-enable-hover" data-token-index="3" style="font-style:italic">e</span> + <span class="notion-enable-hover" data-token-index="5" style="font-style:italic">e</span>的向量即可。</div></div><div class="notion-selectable notion-text-block" data-block-id="6382aeb3-eb21-4cf8-8dd6-129a02ba2a49" style="width: 100%; max-width: 100%; margin-top: 2px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-style:italic">o</span><span class="notion-enable-hover" data-token-index="1" style="font-style:italic">b</span><span class="notion-enable-hover" data-token-index="2" style="font-style:italic">a</span><span class="notion-enable-hover" data-token-index="3" style="font-style:italic">m</span><span class="notion-enable-hover" data-token-index="4" style="font-style:italic">a</span></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="8aa22c2d-8eaf-4237-8d47-2d6482d4bcae" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-style:italic">u</span><span class="notion-enable-hover" data-token-index="1" style="font-style:italic">s</span><span class="notion-enable-hover" data-token-index="2" style="font-style:italic">a</span></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="e36c6770-8a6c-4765-9378-730d3805cdd0" style="width: 100%; max-width: 100%; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-style:italic">r</span><span class="notion-enable-hover" data-token-index="1" style="font-style:italic">u</span><span class="notion-enable-hover" data-token-index="2" style="font-style:italic">s</span><span class="notion-enable-hover" data-token-index="3" style="font-style:italic">s</span><span class="notion-enable-hover" data-token-index="4" style="font-style:italic">i</span><span class="notion-enable-hover" data-token-index="5" style="font-style:italic">a</span></div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="b177393a-92bc-4ebd-8e6f-1d8e39818e41" style="width: 100%; max-width: 100%; align-self: flex-start; margin-top: 4px; margin-bottom: 0px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="2377665cd6aa16bcc213ae5cd94db2239ee617bb.jpg" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="baebb905-57c5-4f47-9727-00304da94718" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">使用词嵌入得到的向量替代One-Hot向量还有一个非常大的好处：我们的网络可以在训练集未出现过的词语上也有着比较好的表现。比如我们的网络的训练数据（不是指词嵌入的训练数据）中只含有“Apple”而没有“Orange”，但是在实际应用过程中由于“Apple”和“Orange”都被转化成为两个非常相近的词向量输入算法，算法从应对“Apple”上学习到的行为也可以很好复现在“Orange”输入中，毕竟相似的输入会引发相似的网络隐藏层变化。</div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="223b48f6-8a36-4ce9-841e-850855c5250e" style="width: 100%; max-width: 1718px; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.25em; line-height: 1.3;">使用词嵌入算法</div></div></div><div class="notion-selectable notion-text-block" data-block-id="c10bcf47-6f63-4539-8255-b61ca4acb3b9" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">我们因此知道，我们可从词嵌入中得到的巨大好处就是我们可以用非常多的文本训练一个强大的词嵌入模型，再使用这个模型编码我们自己的训练任务（翻译，词性标注等等）的输入词语，我们只需要不多的训练数据就可以使我们的算法在各种语句中都表现良好。这样的操作之所以可行的原因是因为训练一个强大词嵌入模型可比训练一个强大的翻译模型简单多了，接下来我们会了解到词嵌入模型的训练是自监督的，只需要给它非常多的语句而不需要人工标记就可以完成训练。当然，实际上也存在比上述方法更简单而巧妙的运用词嵌入的方法：上网下载一个词嵌入模型。</div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="fc59ba81-db3b-4fff-92d6-e59fa8973e07" style="width: 100%; max-width: 1718px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.5em; line-height: 1.3;">学习词嵌入</div></div></div><div class="notion-selectable notion-text-block" data-block-id="01de50ba-5c42-4e1b-96b9-f6b8541765a1" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">要怎样才能训练一个词嵌入模型呢？首先我们要知道我们最终要学习的目标——<span class="notion-enable-hover" data-token-index="1" style="font-weight:600">嵌入矩阵（Embedding Matrix）</span>。如果每个词语都对应了一个独一无二的300维词向量，而每个词语又是以一个10000维One-Hot向量表示的，那么我们可以设计一个矩阵使得<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">E</span> × <span class="notion-enable-hover" data-token-index="5" style="font-style:italic">o</span><span class="notion-enable-hover" data-token-index="6" style="font-style:italic">i</span> = <span class="notion-enable-hover" data-token-index="8" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="9" style="font-style:italic">i</span>，<span class="notion-enable-hover" data-token-index="11" style="font-style:italic">E</span>就是叫做嵌入矩阵。这个矩阵的维度为ℝ[300, 10000]，其中第<span class="notion-enable-hover" data-token-index="15" style="font-style:italic">i</span>列的值就是第<span class="notion-enable-hover" data-token-index="17" style="font-style:italic">i</span>个词语对应的嵌入向量。当然实际上我们在实践时不会真的使用这个庞大的矩阵乘法求的对应的词向量，在词嵌入训练好了以后，我么可能使用一个字典之类的数据结构来快速索引每个词对应的词向量。</div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="ae37ec85-f61a-4997-8f53-8d1680227e29" style="width: 100%; max-width: 1718px; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.25em; line-height: 1.3;">神经概率语言模型</div></div></div><div class="notion-selectable notion-text-block" data-block-id="d60aa30f-de88-4234-93fb-7cf57327273f" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">我们用来训练嵌入矩阵的模型就叫做<span class="notion-enable-hover" data-token-index="1" style="font-weight:600">神经概率语言模型（Neural Probabilistic Language Model）</span>，这个模型实现的任务是通过上下文来预测句子中间的某一个词。我们的嵌入矩阵<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">E</span>就是这个模型中的一个参数，在训练这个模型的同时我们就使用梯度下降优化矩阵<span class="notion-enable-hover" data-token-index="5" style="font-style:italic">E</span>来得到最终的嵌入矩阵。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="eb81bbc2-2684-440d-b7d1-79ece4ff739d" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">我们这里使用最简单的一种神经概率语言模型来演示训练嵌入矩阵的过程。我们把一句话拆成两个部分，输出叫做Target，是这句话的最后一个单词；输入叫做Context，包含了这句话的除了最后一个单词以外的其他词语。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="087d1b27-a6ac-4e08-b4a8-9eaec6cfbbd9" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">这个神经概率语言模型接受Context输入，试图猜测出Target单词。我们假设现在我们的训练数据是“I want a glass of orange (juice)”，“juice”即是target词语，那么我们这样构建我们的模型：</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="32c35a70-14a4-4888-b3d1-d4def838b1f1" style="width: 100%; max-width: 1910px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="bcfca21c78e6c343a379e7dfb6345a29d3c0b11a.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="bc5f204f-497c-49db-88c1-893c69cfbf79" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">截屏2021-06-03 下午5.08.47</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="3b0cca3e-92b3-4917-8426-d76aa9e970f6" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">在上述模型中，<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">E</span>，全连接层的<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">W</span>[1], <span class="notion-enable-hover" data-token-index="6" style="font-style:italic">b</span>[1]和Softmax层的<span class="notion-enable-hover" data-token-index="9" style="font-style:italic">W</span>[2], <span class="notion-enable-hover" data-token-index="12" style="font-style:italic">b</span>[2]都是可学习的参数，很明显，要是网络不设计出一个能够很好压缩词语空间，表征单词的具体含义的<span class="notion-enable-hover" data-token-index="15" style="font-style:italic">E</span>矩阵的话，它的损失函数可不会对它手下留情。而我们需要做的仅仅是去寻找大量的这样的句子输入网络就可以了。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="31309484-d8df-4b97-89b8-e6454a16f7e9" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">在实际操作中由于全连接神经网络只能接受固定长度的输入，我们一般只取Target词前的固定几个词输入网络。当然，不输入前几个词也是可以的——可以输入后几个词或者前后挑几个词。（事实证明，不同的Context方法都可以达到很不错的效果）。</div></div></div></div><div class="notion-selectable notion-sub_header-block" data-block-id="582d4ba4-a28d-45ac-bf3c-fdb270e37b82" style="width: 100%; max-width: 1718px; margin-top: 1.4em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 2" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.5em; line-height: 1.3;">Word2Vec</div></div></div><div class="notion-selectable notion-text-block" data-block-id="3c64c0a0-5a3f-4bab-bf40-bfb1363d395e" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Word2Vec是一种简单高效的词嵌入学习算法，在整体上它和上面的神经概率模型有一定的相似之处，但是它更加简洁。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="81d64380-5a20-4f7c-b180-5942bd4534c6" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">首先从选择Context词语和Target词语的角度来看，Word2Vec模型主要分为两种类型：<span class="notion-enable-hover" data-token-index="1" style="font-weight:600">Skip-Gram</span>和<span class="notion-enable-hover" data-token-index="3" style="font-weight:600">Continuous Bag of Words（CBOW）</span>。其中，CBOW模型在一句话中随机选择一个词语作为Target词语，之后取它的前后几个相邻的词语作为Context输入；而Skip-Gram则恰恰相反，我们选择一个词语作为输入，并且在它的附近的一定范围内（比如前后5个单词以内）随机取一个单词作为Target，我们希望算法可以预测出这个词语。我们这里只对Skip-Gram模型作进一步的介绍。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="ec1c1aab-5e30-4568-bee5-635138061328" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">现在我们的语料库中有这样一句话“The quick brown fox jumps over the lazy dog”。那么我们如果选择了“Fox”作为Context词语，那么我们可能可以从这句话中提取到的(<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">c</span>, <span class="notion-enable-hover" data-token-index="3" style="font-style:italic">t</span>)数据对就可能包括Fox → Brown，Fox → The，Fox → Lazy，Fox → Dog等等序对。我们将把这些数据输入下面的这个模型中进行训练 $$
\hat y = P\left( t | c \right) = \frac{e^{\theta_{t}^{T}e_{c}}}{\sum_{j = 1}^{10000}e^{\theta_{j}^{T}e_{c}}}
$$</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="819c30f9-3327-41ab-afd9-7bb8f269ef08" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">其中，<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">θ</span><span class="notion-enable-hover" data-token-index="2" style="font-style:italic">t</span> 为目标词对应的参数，<span class="notion-enable-hover" data-token-index="4" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="5" style="font-style:italic">c</span> 为context文词的嵌入向量，且 <span class="notion-enable-hover" data-token-index="7" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="8" style="font-style:italic">c</span> = <span class="notion-enable-hover" data-token-index="10" style="font-style:italic">E</span><span class="notion-enable-hover" data-token-index="11" style="font-style:italic">o</span><span class="notion-enable-hover" data-token-index="12" style="font-style:italic">c</span>，<span class="notion-enable-hover" data-token-index="14" style="font-style:italic">o</span><span class="notion-enable-hover" data-token-index="15" style="font-style:italic">c</span> 为上下文词的 one-hot 向量。而我们的损失函数依然是交叉熵函数： $$
L(\hat y, y) = -\sum^{10000}_{i=1}y_ilog\hat y_i
$$ 经过一段时间的训练，我们可以学习到SoftMax的参数<span class="notion-enable-hover" data-token-index="19" style="font-style:italic">θ</span>和嵌入矩阵<span class="notion-enable-hover" data-token-index="21" style="font-style:italic">E</span>。其中只有<span class="notion-enable-hover" data-token-index="23" style="font-style:italic">E</span>是我们想要的。</div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="48963d87-b023-4aba-975f-96d98b67117b" style="width: 100%; max-width: 1718px; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.25em; line-height: 1.3;">Word2Vec的缺点</div></div></div><div class="notion-selectable notion-text-block" data-block-id="436e3696-3c75-4a26-8365-790466dba317" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">Word2Vec最主要的缺点就是它确实是有点慢，这主要是SoftMax的锅——每次迭代都需要计算词典中一万个词语的<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="2" style="font-style:italic">θ</span><span class="notion-enable-hover" data-token-index="3" style="font-style:italic">j</span><span class="notion-enable-hover" data-token-index="4" style="font-style:italic">T</span><span class="notion-enable-hover" data-token-index="5" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="6" style="font-style:italic">c</span>。这个计算量实在是太大了。为了解决这个问题，我们可以使用Hierarchical Softmax（层次Softmax）解决这个问题。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="287e0139-b59a-4424-8c15-85f79c60dbcb" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">首先我们可以把所有的词语都构建成一棵二叉树，所有的词语都是叶节点，而每个非叶子节点就是一个小神经网络，它的输出结果用于判断<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">“输入词语c，目标词t会出现在这个节点的左子树还是右子树？”</span>很明显，这样的一个小网络应该是使用Sigmoid激活函数的。</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="db8f17d2-7b33-46ac-95f8-17de7faf6834" style="width: 100%; max-width: 1910px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="81432b7cd21b45db41811be8884f777a263df81b.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="c740725f-ac76-4200-8427-96b15911bd01" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">截屏2021-06-05 下午4.20.27</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="1a347b8b-c413-408b-b02d-0dd78eafaea8" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">上图中虽然每个节点都画成一样的了，但是他们的参数其实是各自独立训练的。那么对于现在的任何一对(<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">c</span>, <span class="notion-enable-hover" data-token-index="3" style="font-style:italic">t</span>)数据对，我们就可以在这棵树中选择某几个节点，只要这几个节点的网络能够做出正确的选择（在这里，输出概率的含义是“有多大的概率，t出现在左子树中”），我们就可以做到在给定一个上下文词语c时，预测到一个正确的目标词语t出现的概率，并使之趋向于1。在训练的过程中，我们也只对这几个节点进行监督，监督使用的正确y到底是0还是1取决于这条路的正确方向。正如下图两个树所示：</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="5d1cd595-4850-4a4b-9139-2fa8bde8fbcd" style="width: 100%; max-width: 1910px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="96735a84b94d26b582826b2b88c4f6fbeba17399.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="69b4d699-2d8e-42d5-91fe-1d3d7642d1f1" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">截屏2021-06-05 下午4.28.01</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="a5601482-340d-4af7-9baf-9c5daf1fae6a" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">原先我们计算给定上下文词语c，目标词语t的概率是$\hat y = \frac{e^{\theta_{t}^{T}e_{c}}}{\sum_{j = 1}^{10000}e^{\theta_{j}^{T}e_{c}}}$，如果我们一共有|<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">V</span>|个词语，我们一共需要计算|<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">V</span>|次的<span class="notion-enable-hover" data-token-index="5" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="6" style="font-style:italic">θ</span><span class="notion-enable-hover" data-token-index="7" style="font-style:italic">j</span><span class="notion-enable-hover" data-token-index="8" style="font-style:italic">T</span><span class="notion-enable-hover" data-token-index="9" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="10" style="font-style:italic">c</span>。而现在由于二叉树的深度大约为log2|<span class="notion-enable-hover" data-token-index="14" style="font-style:italic">V</span>|，我们最多只需要计算log2|<span class="notion-enable-hover" data-token-index="18" style="font-style:italic">V</span>|个逻辑回归了！不在这个c -&gt; t路径上的逻辑回归就根本不会被计算和监督。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="20252268-99e7-46b7-b0a9-687d2f89712c" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">这个方法由于篇幅限制不会讨论太多，总的来说有以下几点需要注意：</div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="70296022-a492-49f3-be68-eb3794632515" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">在原来的SoftMax方法中，我们要为<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">V</span>个词语都分配一份可学习参数，而在这个模型中，由于树有V-1个非叶子节点，我们需要的总参数量依然是差不多的。</div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="e759bab9-8bef-4f43-bdef-e1d52569d7bc" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">那如果在训练时，我们还是想计算词语t出现的具体概率要怎么办呢？我们只需要把沿路上的所有节点输出概率相乘即可。当目标词语在某个节点的左子树时我们乘以<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">σ</span>(<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">W</span><span class="notion-enable-hover" data-token-index="4" style="font-style:italic">c</span> + <span class="notion-enable-hover" data-token-index="6" style="font-style:italic">b</span>)，当目标词在右子树时我们乘以1 − <span class="notion-enable-hover" data-token-index="8" style="font-style:italic">σ</span>(<span class="notion-enable-hover" data-token-index="10" style="font-style:italic">W</span><span class="notion-enable-hover" data-token-index="11" style="font-style:italic">c</span> + <span class="notion-enable-hover" data-token-index="13" style="font-style:italic">b</span>)。这样子我们可以保证所有的词语的概率之和为1。</div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="72153043-8a40-4498-ba0c-e38822ed9d19" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">实际操作中，我们会更有技巧地使用哈夫曼树（Huffman Tree）而非平衡二叉树来构建我们的树，它可以使得高频词语的深度更低，当目标词语是高频词汇时，我们对这个词汇而言需要的计算量就小的多了。</div></div></div></div></div><div class="notion-selectable notion-bulleted_list-block" data-block-id="e6e526db-6818-4506-9ff0-bb9b8020299a" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="display: flex; align-items: flex-start; width: 100%; padding-left: 2px; color: inherit; fill: inherit;"><div class="pseudoSelection" contenteditable="false" data-content-editable-void="true" data-text-edit-side="start" style="user-select: none; --pseudoSelection--background:transparent; margin-right: 2px; width: 24px; display: flex; align-items: center; justify-content: center; flex-grow: 0; flex-shrink: 0; min-height: calc(1.5em + 3px + 3px);"><div class="pseudoBefore" style='font-size: 1.5em; line-height: 1; margin-bottom: 0px; --pseudoBefore--fontFamily:Arial; --pseudoBefore--content:"•";'></div></div><div style="flex: 1 1 0px; min-width: 1px; display: flex; flex-direction: column;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="List" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; text-align: left;">训练时我们可以把沿路的节点输出概率相乘得到目标词汇的概率；但是在测试时如果我们想知道给定词语<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">c</span>，哪个词语最有可能是目标词t，我们不能每次就在一个节点上计算概率并沿着概率大的方向走，这样走到的终点不一定是概率最大点！因此我们还是得老老实实把所有节点的概率都算出来，得到每个词语的概率。</div></div></div></div></div><div class="notion-selectable notion-sub_sub_header-block" data-block-id="42768c5d-da18-4d28-8183-2308476132cf" style="width: 100%; max-width: 1718px; margin-top: 1em; margin-bottom: 1px;"><div style="display: flex; width: 100%; color: inherit; fill: inherit;"><div contenteditable="false" data-content-editable-leaf="true" placeholder="Heading 3" spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px; font-weight: 600; font-size: 1.25em; line-height: 1.3;">负采样</div></div></div><div class="notion-selectable notion-text-block" data-block-id="1dd640e9-b6b8-4b00-bfb9-f717fb23aaea" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">负采样方法和层级SoftMax都可以很好的解决Softmax计算过慢的问题。什么是负采样？简单来说，就是在采样一些有关的词语对(<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">c</span>, <span class="notion-enable-hover" data-token-index="3" style="font-style:italic">t</span>)的同时，也采样一些根本无关的词语，并告诉网络：这些词是无关的！于是我们的任务从判断该目标词语的出现概率变成了判断两个词语是否有关，SoftMax分类任务变成了一个判断任务！</div></div></div></div><div class="notion-selectable notion-image-block" data-block-id="668c3359-5278-408e-8ce1-91dcb476ce8a" style="width: 100%; max-width: 1910px; align-self: center; margin-top: 4px; margin-bottom: 4px;"><div contenteditable="false" data-content-editable-void="true"><div style="display: flex;"><div class="notion-cursor-default" style="position: relative; overflow: hidden; flex-grow: 1;"><div style="position: relative;"><div><div style="width: 100%; height: 100%;"><img referrerpolicy="same-origin" src="4be87978aaf86a6bc3af1389e06a649388434a08.png" style="display: block; object-fit: cover; border-radius: 1px; pointer-events: auto; width: 100%;"/></div></div></div></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="e890abb6-aa0d-4b5d-a320-2867acf126e8" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">如图所示，我们通过选择一些有关或者无关的词语对构成我们训练集中的正例和负例。选择正例的方法和之前的Skip-Gram方法如出一辙，那么如何选择负例呢？很简单，我们只需要从整个词典里随便选几个词语就可以了，大概率这些随机选择的词语不会和我们选中的词语有任何关系。每设置一对有关的词语对，我们就寻找<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">k</span>对无关的词语对。一般来说，当语料库数据集大小比较大的时候，我们可以设置<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">k</span> = 2 ∼ 5，而当数据集比较小的时候，我们可以设置<span class="notion-enable-hover" data-token-index="5" style="font-style:italic">k</span> = 5 ∼ 20。于是我们现在可以这么描述我们的判断模型： <span class="notion-enable-hover" data-token-index="7" style="font-style:italic">P</span>(<span class="notion-enable-hover" data-token-index="9" style="font-style:italic">y</span> = 1|<span class="notion-enable-hover" data-token-index="11" style="font-style:italic">c</span>, <span class="notion-enable-hover" data-token-index="13" style="font-style:italic">t</span>) = <span class="notion-enable-hover" data-token-index="15" style="font-style:italic">σ</span>(<span class="notion-enable-hover" data-token-index="17" style="font-style:italic">θ</span><span class="notion-enable-hover" data-token-index="18" style="font-style:italic">t</span><span class="notion-enable-hover" data-token-index="19" style="font-style:italic">T</span><span class="notion-enable-hover" data-token-index="20" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="21" style="font-style:italic">c</span>) 其中<span class="notion-enable-hover" data-token-index="24" style="font-style:italic">θ</span><span class="notion-enable-hover" data-token-index="25" style="font-style:italic">t</span>是模型分配给第t个词语的参数，而<span class="notion-enable-hover" data-token-index="27" style="font-style:italic">e</span><span class="notion-enable-hover" data-token-index="28" style="font-style:italic">c</span>是Context词语的词向量。这样，原先计算量很大的多分类问题就变成了计算量很小的二分类问题了。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="538f13e5-7954-4d95-86ea-5bd56e88c72e" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">但是一个问题是，如果我们随机的从词典里抽取出<span class="notion-enable-hover" data-token-index="1" style="font-style:italic">k</span>对无关的词语，那么每个词语被抽取到的概率是一样大的。但是我们可能会希望可以更加着重地处理那些比较经常出现的词语，而少关注一些不那么经常出现的词语。那我们可以把照单词在语料库里出现的频率作为抽取概率，但是如果这样那么我们可能又会把过多的时间用来处理“a”，“the”，“of“之类的词语，这样也不太好。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="9bdd8e0b-7b4a-43b7-9d73-62743b71f9ef" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">于是一种比较好的方法是采用以下公式计算抽取概率： $$
P(w_i)=\frac{f(w_i)^{\frac 34}}{\sum_{i=1}^mf(w_i)^\frac{3}{4}}
$$ 其中<span class="notion-enable-hover" data-token-index="3" style="font-style:italic">f</span>(<span class="notion-enable-hover" data-token-index="5" style="font-style:italic">w</span><span class="notion-enable-hover" data-token-index="6" style="font-style:italic">i</span>)代表语料库中<span class="notion-enable-hover" data-token-index="8" style="font-style:italic">w</span><span class="notion-enable-hover" data-token-index="9" style="font-style:italic">i</span>出现的概率。如果我们把这个公式中的3/4换成1，这就是完全把频率作为概率进行抽取；而如果把3/4换成0，那这就是完全的均匀抽取。于是乎我们可以把这个式子看作是在两种极端之间的一种权衡。</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="5a99641d-14f5-4cbd-942a-f5500aef4fde" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;"><span class="notion-enable-hover" data-token-index="0" style="font-weight:600">参考资料：</span></div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="15772f80-8763-4322-88b6-4978c3bd4708" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">[1] Coursera Deeplearning.AI深度学习教程：https://www.coursera.org/specializations/deep-learning</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="9922de46-72d0-41d7-9aee-d7c37cda112c" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 1px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">[2] Hierarchical Softmax（层次Softmax）https://zhuanlan.zhihu.com/p/56139075</div></div></div></div><div class="notion-selectable notion-text-block" data-block-id="ea7abd71-d2cf-4353-9af8-c40051f52dc5" style="width: 100%; max-width: 1718px; margin-top: 1px; margin-bottom: 0px;"><div style="color: inherit; fill: inherit;"><div style="display: flex;"><div contenteditable="false" data-content-editable-leaf="true" placeholder=" " spellcheck="true" style="max-width: 100%; width: 100%; white-space: pre-wrap; word-break: break-word; caret-color: rgb(55, 53, 47); padding: 3px 2px;">[3] On word embeddings - Part 2: Approximating the Softmax https://ruder.io/word-embeddings-softmax/index.html#hierarchicalsoftmax</div></div></div></div></div></div><div contenteditable="false" data-content-editable-void="true" style="width: 0px;"><div style="display: none; flex-shrink: 0; pointer-events: none; width: 0px; position: absolute; right: 192px; opacity: 0;"><div style="display: flex; flex-direction: column; padding: 5px 16px; width: 340px; flex-shrink: 0; height: 100%; position: relative; pointer-events: none; z-index: 1;"><div style="position: absolute; pointer-events: none; width: 100%; height: 100%; top: -5px; background: linear-gradient(white 0px, rgba(255, 255, 255, 0) 15px);"></div></div></div></div></main><span style="height: 1px; width: 1px;"></span></div><div class="notion-presence-container" style="position: absolute; top: 0px; left: 0px; z-index: 89;"><div></div></div></div></div></div><div class="notion-peek-renderer" style="position: fixed; top: 0px; right: 0px; bottom: 0px; width: 960px; z-index: 109; transform: translateX(960px) translateZ(0px);"></div></div></div></div></div><script src="1172e9111a5fb396bcb8a05870b5eabf8abf221c.js" type="text/javascript"></script><div style="width: env(safe-area-inset-bottom);"></div></body></html>